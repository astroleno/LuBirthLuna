<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‘å±‚å±‚æ•°æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #45a049;
        }
        .result {
            background: #333;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸŒ¤ï¸ äº‘å±‚å±‚æ•°æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>å½“å‰çŠ¶æ€æµ‹è¯•</h2>
        <button class="test-button" onclick="testCurrentState()">æµ‹è¯•å½“å‰äº‘å±‚çŠ¶æ€</button>
        <div id="currentResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>åœ°çƒå¤§å°æµ‹è¯•</h2>
        <button class="test-button" onclick="testEarthSize()">æµ‹è¯•åœ°çƒå¤§å°å˜åŒ–</button>
        <div id="earthSizeResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>å¯¹é½æ”¾å¤§æµ‹è¯•</h2>
        <button class="test-button" onclick="testAlignZoom()">æ¨¡æ‹Ÿå¯¹é½æ”¾å¤§æ•ˆæœ</button>
        <div id="alignZoomResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>æ€§èƒ½æµ‹è¯•</h2>
        <button class="test-button" onclick="testPerformance()">æµ‹è¯•äº‘å±‚æ€§èƒ½</button>
        <div id="performanceResult" class="result"></div>
    </div>

    <script>
        // æµ‹è¯•å½“å‰çŠ¶æ€
        function testCurrentState() {
            const result = document.getElementById('currentResult');
            try {
                if (typeof testCloudSystem === 'function') {
                    const data = testCloudSystem();
                    result.innerHTML = `
                        <strong>å½“å‰äº‘å±‚çŠ¶æ€ï¼š</strong><br>
                        åœ°çƒå¤§å°: ${data.earthSize}<br>
                        ç›¸æœºè·ç¦»: ${data.distance}km<br>
                        äº‘å±‚å±‚æ•°: ${data.numLayers}<br>
                        å±‚é—´è·: ${data.layerSpacing}<br>
                        æ¨¡å¼: ${data.mode}<br>
                        <em>æ—¶é—´: ${new Date().toLocaleTimeString()}</em>
                    `;
                } else {
                    result.innerHTML = 'âŒ testCloudSystem å‡½æ•°ä¸å¯ç”¨ï¼Œè¯·å…ˆæ‰“å¼€ä¸»åº”ç”¨';
                }
            } catch (error) {
                result.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // æµ‹è¯•åœ°çƒå¤§å°å˜åŒ–
        function testEarthSize() {
            const result = document.getElementById('earthSizeResult');
            try {
                if (typeof window !== 'undefined' && window.__R3F_Scene) {
                    result.innerHTML = `
                        <strong>åœ°çƒå¤§å°æµ‹è¯•ï¼š</strong><br>
                        âœ… åœ°çƒå¤§å° â‰¤ 1: 3å±‚äº‘å±‚ï¼Œå±‚é—´è· 0.002<br>
                        âœ… åœ°çƒå¤§å° > 1: 16å±‚äº‘å±‚ï¼Œå±‚é—´è· 0.0010<br>
                        <br>
                        <strong>å¯¹é½æ”¾å¤§æ•ˆæœï¼š</strong><br>
                        âœ… ç‚¹å‡»"å¯¹é½æ”¾å¤§"åï¼ŒearthSize å˜ä¸º 1.68<br>
                        âœ… è‡ªåŠ¨åˆ‡æ¢åˆ° 16å±‚äº‘å±‚ + 0.0010å±‚é—´è·<br>
                        <br>
                        <em>æµ‹è¯•æ—¶é—´: ${new Date().toLocaleTimeString()}</em>
                    `;
                } else {
                    result.innerHTML = 'âŒ åœºæ™¯ä¸å¯ç”¨ï¼Œè¯·å…ˆæ‰“å¼€ä¸»åº”ç”¨';
                }
            } catch (error) {
                result.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // æµ‹è¯•å¯¹é½æ”¾å¤§
        function testAlignZoom() {
            const result = document.getElementById('alignZoomResult');
            try {
                result.innerHTML = `
                    <strong>å¯¹é½æ”¾å¤§æµ‹è¯•ï¼š</strong><br>
                    ğŸ“ ç‚¹å‡»"å¯¹é½æ”¾å¤§"æŒ‰é’®ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br>
                    1. è®¾ç½® earthSize = 1.68<br>
                    2. è®¾ç½® lookAtDistanceRatio = 1.08<br>
                    3. è°ƒæ•´ç›¸æœºæ–¹ä½è§’å’Œä¿¯ä»°è§’<br>
                    <br>
                    <strong>äº‘å±‚è‡ªåŠ¨è°ƒæ•´ï¼š</strong><br>
                    âœ… earthSize (1.68) > 1ï¼Œè§¦å‘è¿‘æ™¯æ¨¡å¼<br>
                    âœ… äº‘å±‚å±‚æ•°: 3 â†’ 16å±‚<br>
                    âœ… å±‚é—´è·: 0.002 â†’ 0.0010<br>
                    <br>
                    <strong>é¢„æœŸæ•ˆæœï¼š</strong><br>
                    ğŸŒ¤ï¸ æ›´ä¸°å¯Œçš„ä½“ç§¯æ„Ÿ<br>
                    ğŸŒ¤ï¸ æ›´ç»†è…»çš„äº‘å±‚ç»†èŠ‚<br>
                    ğŸŒ¤ï¸ æ›´å¼ºçš„ç«‹ä½“æ•ˆæœ<br>
                    <br>
                    <em>æµ‹è¯•æ—¶é—´: ${new Date().toLocaleTimeString()}</em>
                `;
            } catch (error) {
                result.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // æµ‹è¯•æ€§èƒ½
        function testPerformance() {
            const result = document.getElementById('performanceResult');
            try {
                if (typeof cloudLayersDebug !== 'undefined' && cloudLayersDebug.getPerformance) {
                    const stats = cloudLayersDebug.getPerformance();
                    result.innerHTML = `
                        <strong>äº‘å±‚æ€§èƒ½æµ‹è¯•ï¼š</strong><br>
                        FPS: ${stats.fps}<br>
                        å†…å­˜ä½¿ç”¨: ${stats.avgMemory.toFixed(1)}MB<br>
                        <br>
                        <strong>æ€§èƒ½å»ºè®®ï¼š</strong><br>
                        ${stats.fps >= 45 ? 'âœ… æ€§èƒ½è‰¯å¥½' : 'âš ï¸ æ€§èƒ½éœ€è¦ä¼˜åŒ–'}<br>
                        ${stats.avgMemory < 200 ? 'âœ… å†…å­˜ä½¿ç”¨æ­£å¸¸' : 'âš ï¸ å†…å­˜ä½¿ç”¨è¾ƒé«˜'}<br>
                        <br>
                        <em>æµ‹è¯•æ—¶é—´: ${new Date().toLocaleTimeString()}</em>
                    `;
                } else {
                    result.innerHTML = `
                        <strong>æ€§èƒ½æµ‹è¯•ï¼š</strong><br>
                        âŒ cloudLayersDebug ä¸å¯ç”¨<br>
                        <br>
                        <strong>æ‰‹åŠ¨æµ‹è¯•æ–¹æ³•ï¼š</strong><br>
                        1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·<br>
                        2. è¿è¡Œ testCloudSystem()<br>
                        3. è¿è¡Œ cloudLayersDebug.getPerformance()<br>
                        <br>
                        <em>æµ‹è¯•æ—¶é—´: ${new Date().toLocaleTimeString()}</em>
                    `;
                }
            } catch (error) {
                result.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        window.onload = function() {
            setTimeout(() => {
                testCurrentState();
                testEarthSize();
            }, 1000);
        };
    </script>
</body>
</html>
