<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出生点对齐验证测试</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px; 
            font-family: Arial, sans-serif; 
            background: #f0f0f0;
        }
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .section-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .code-block {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .test-step {
            margin: 8px 0;
            padding-left: 20px;
        }
        .test-step::before {
            content: "▶ ";
            color: #007bff;
        }
        .coordinate-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .coordinate-table th, .coordinate-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .coordinate-table th {
            background: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>出生点对齐验证测试</h1>
        
        <div class="test-section">
            <div class="section-title">🔍 问题分析结果</div>
            <div class="success">
                <strong>找到的问题：</strong><br>
                1. ✅ 实际使用的是 <code>SimpleTest</code> 组件（不是 SimpleEarthMoonScene）<br>
                2. ✅ <code>lonDeg</code> 状态默认值为 0，而不是期望的 -90<br>
                3. ✅ 出生点对齐逻辑中判断条件使用 <code>!== 0</code>，但默认值现在是 -90<br>
                4. ✅ 坐标系统已经修复（经度偏移90度）
            </div>
        </div>

        <div class="test-section">
            <div class="section-title">🛠️ 已实施的修复</div>
            <div class="code-block">
// 修复1：SimpleTest.tsx 中的默认经度值
const [lonDeg, setLonDeg] = useState<number>(-90);   // 本初子午线默认

// 修复2：出生点对齐逻辑中的判断条件
birthPointLongitudeDeg: paramLonDeg !== undefined ? paramLonDeg : 
  (prev.birthPointLongitudeDeg !== -90 ? prev.birthPointLongitudeDeg : lonDeg)
            </div>
        </div>

        <div class="test-section">
            <div class="section-title">📊 坐标系统说明</div>
            <table class="coordinate-table">
                <tr>
                    <th>地理位置</th>
                    <th>标准经度</th>
                    <th>系统内部经度</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>本初子午线</td>
                    <td>0°</td>
                    <td>-90°</td>
                    <td>格林威治，伦敦附近</td>
                </tr>
                <tr>
                    <td>东经90°</td>
                    <td>90°</td>
                    <td>0°</td>
                    <td>亚洲/太平洋区域（中国西部、尼泊尔）</td>
                </tr>
                <tr>
                    <td>上海</td>
                    <td>121°</td>
                    <td>31°</td>
                    <td>中国东部</td>
                </tr>
                <tr>
                    <td>美国中部</td>
                    <td>-90°到-100°</td>
                    <td>-180°到-190°</td>
                    <td>芝加哥、德克萨斯等</td>
                </tr>
            </table>
        </div>

        <div class="test-section">
            <div class="section-title">🧪 验证步骤</div>
            <div class="test-step">启动开发服务器：<code>npm run dev</code></div>
            <div class="test-step">访问：<code>http://localhost:5173/</code></div>
            <div class="test-step">观察默认显示：应该显示亚洲/太平洋区域（东经90°附近）</div>
            <div class="test-step">检查默认出生点：应该显示本初子午线（0°，对应系统内部-90°）</div>
            <div class="test-step">启用出生点对齐功能</div>
            <div class="test-step">点击对齐按钮，观察本初子午线是否移动到屏幕中心</div>
            <div class="test-step">测试上海：设置经度121°，纬度31°，测试对齐</div>
        </div>

        <div class="test-section">
            <div class="section-title">🎯 预期结果</div>
            <div class="success">
                <strong>修复后的预期行为：</strong><br>
                • 默认显示：尼泊尔/西藏区域（东经84°，接近东经90°）在屏幕中心 ✓<br>
                • 默认出生点：本初子午线（0°）在屏幕左侧 ✓<br>
                • 点击对齐后：本初子午线移动到屏幕中心 ✓<br>
                • 上海对齐：上海（121°）应该准确移动到屏幕中心 ✓<br>
                • 不再出现：对齐到美国中部的问题 ✗
            </div>
        </div>

        <div class="test-section">
            <div class="section-title">🔧 调试方法</div>
            <div class="code-block">
// 在浏览器地址栏添加调试参数
http://localhost:5173/?debug=1

// 在浏览器控制台中执行测试命令
window.setBirthPointAlignment(true, -90, 0)  // 对齐到本初子午线
window.setBirthPointAlignment(true, 31, 0)   // 对齐到上海（系统内部31°）
window.setBirthPointAlignment(true, -180, 40) // 对齐到美国中部
            </div>
        </div>

        <div class="test-section">
            <div class="section-title">📝 测试结果记录</div>
            <textarea id="testResults" style="width: 100%; height: 120px; margin: 10px 0;" 
                placeholder="请记录测试结果：
1. 默认显示位置：
2. 默认出生点坐标：
3. 对齐后位置：
4. 上海对齐测试：
5. 其他观察："></textarea>
            <button onclick="saveResults()" style="background: #007bff; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer;">保存结果</button>
        </div>
    </div>

    <script>
        function saveResults() {
            const results = document.getElementById('testResults').value;
            if (results.trim()) {
                alert('测试结果已保存！\n\n' + results);
                console.log('出生点对齐测试结果：', results);
            } else {
                alert('请先输入测试结果');
            }
        }
        
        // 页面加载完成提示
        window.addEventListener('load', function() {
            console.log('出生点对齐验证测试页面已加载');
            console.log('请按照上述步骤进行测试验证');
        });
    </script>
</body>
</html>