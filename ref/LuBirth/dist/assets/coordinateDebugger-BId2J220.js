import{M as c,V as a,a as g}from"./index-d3XrTYz9.js";class u{static testKnownLocations(){const s=[{name:"ä¸Šæµ·",lon:121.47,lat:31.23},{name:"åŒ—äº¬",lon:116.41,lat:39.9},{name:"çº½çº¦",lon:-74.01,lat:40.71},{name:"ä¼¦æ•¦",lon:-.13,lat:51.51},{name:"ä¸œäº¬",lon:139.69,lat:35.69},{name:"æ‚‰å°¼",lon:151.21,lat:-33.87},{name:"æœ¬åˆå­åˆçº¿",lon:0,lat:0},{name:"å›½é™…æ—¥æœŸå˜æ›´çº¿",lon:180,lat:0}];console.group("ğŸŒ åæ ‡ç³»æ˜ å°„æµ‹è¯•"),s.forEach(n=>{const e=c.degToRad(n.lat),i=c.degToRad(n.lon),t=new a(Math.cos(e)*Math.sin(i),Math.sin(e),Math.cos(e)*Math.cos(i)),o=new a(0,0,15),h=this.projectToScreen(t,o);console.log(`${n.name}:`,{ç»åº¦:n.lon.toFixed(2)+"Â°",çº¬åº¦:n.lat.toFixed(2)+"Â°",ä¸–ç•Œåæ ‡:{x:+t.x.toFixed(3),y:+t.y.toFixed(3),z:+t.z.toFixed(3)},å±å¹•åæ ‡:{x:+h.x.toFixed(3),y:+h.y.toFixed(3)},æœŸæœ›ä½ç½®:this.getExpectedScreenPosition(n.name)})}),console.groupEnd()}static testLongitudeFormulas(){console.group("ğŸ”„ ç»åº¦è®¡ç®—å…¬å¼æµ‹è¯•");const s={lon:121.47,lat:31.23},n=c.degToRad(s.lat),e=c.degToRad(s.lon);[{name:"å½“å‰å…¬å¼",calculate:(t,o)=>new a(Math.cos(o)*Math.sin(t),Math.sin(o),Math.cos(o)*Math.cos(t))},{name:"æ ‡å‡†åœ°ç†å…¬å¼",calculate:(t,o)=>new a(Math.cos(o)*Math.cos(t),Math.sin(o),Math.cos(o)*Math.sin(t))},{name:"Zè½´ä¸º0Â°ç»åº¦",calculate:(t,o)=>new a(Math.cos(o)*Math.sin(t-Math.PI/2),Math.sin(o),Math.cos(o)*Math.cos(t-Math.PI/2))},{name:"Xè½´ä¸º0Â°ç»åº¦",calculate:(t,o)=>new a(Math.cos(o)*Math.cos(t-Math.PI),Math.sin(o),Math.cos(o)*Math.sin(t-Math.PI))}].forEach(t=>{const o=t.calculate(e,n),h=this.projectToScreen(o,new a(0,0,15));console.log(`${t.name}:`,{ä¸–ç•Œåæ ‡:{x:+o.x.toFixed(3),y:+o.y.toFixed(3),z:+o.z.toFixed(3)},å±å¹•åæ ‡:{x:+h.x.toFixed(3),y:+h.y.toFixed(3)}})}),console.groupEnd()}static testCameraPositions(){console.group("ğŸ“· ç›¸æœºä½ç½®æµ‹è¯•");const s={lon:121.47,lat:31.23},n=c.degToRad(s.lat),e=c.degToRad(s.lon),i=new a(Math.cos(n)*Math.sin(e),Math.sin(n),Math.cos(n)*Math.cos(e));[{name:"é»˜è®¤ä½ç½®",position:new a(0,0,15)},{name:"å·¦ä¾§è§†è§’",position:new a(-10,0,10)},{name:"å³ä¾§è§†è§’",position:new a(10,0,10)},{name:"ä¸Šæ–¹è§†è§’",position:new a(0,10,10)},{name:"å‰æ–¹è§†è§’",position:new a(0,0,20)}].forEach(o=>{const h=this.projectToScreen(i,o.position);console.log(`${o.name}:`,{ç›¸æœºä½ç½®:{x:+o.position.x.toFixed(1),y:+o.position.y.toFixed(1),z:+o.position.z.toFixed(1)},å±å¹•åæ ‡:{x:+h.x.toFixed(3),y:+h.y.toFixed(3)}})}),console.groupEnd()}static projectToScreen(s,n){const e=s.clone().sub(n),i=e.length(),t=45*Math.PI/180,o=Math.tan(t/2)*i,h=e.x/o,l=e.y/o;return new g(h,l)}static getExpectedScreenPosition(s){return{ä¸Šæµ·:"å±å¹•å³ä¾§",åŒ—äº¬:"å±å¹•å³ä¾§",çº½çº¦:"å±å¹•å·¦ä¾§",ä¼¦æ•¦:"å±å¹•ä¸­å¿ƒå·¦ä¾§",ä¸œäº¬:"å±å¹•å³ä¾§",æ‚‰å°¼:"å±å¹•å³ä¸‹è§’",æœ¬åˆå­åˆçº¿:"å±å¹•ä¸­å¿ƒ",å›½é™…æ—¥æœŸå˜æ›´çº¿:"å±å¹•å·¦ä¾§è¾¹ç¼˜"}[s]||"æœªçŸ¥"}static testPhaseShift(){console.group("ğŸ”§ ç›¸ä½å·®ä¿®æ­£æµ‹è¯•");const s={lon:121.47,lat:31.23},n=c.degToRad(s.lat);[0,30,60,90,120,150,180].forEach(i=>{const t=c.degToRad(s.lon+i),o=new a(Math.cos(n)*Math.sin(t),Math.sin(n),Math.cos(n)*Math.cos(t)),h=this.projectToScreen(o,new a(0,0,15));console.log(`ç›¸ä½å·® ${i}Â°:`,{è°ƒæ•´åç»åº¦:(s.lon+i).toFixed(2)+"Â°",ä¸–ç•Œåæ ‡:{x:+o.x.toFixed(3),y:+o.y.toFixed(3),z:+o.z.toFixed(3)},å±å¹•åæ ‡:{x:+h.x.toFixed(3),y:+h.y.toFixed(3)}})}),console.groupEnd()}static runAllTests(){console.log("ğŸš€ å¼€å§‹åæ ‡ç³»è°ƒè¯•æµ‹è¯•..."),this.testKnownLocations(),this.testLongitudeFormulas(),this.testCameraPositions(),this.testPhaseShift(),this.testShanghaiBirthPointIssue(),console.log("âœ… åæ ‡ç³»è°ƒè¯•æµ‹è¯•å®Œæˆ")}static testShanghaiBirthPointIssue(){console.group("ğŸ¯ ä¸Šæµ·å‡ºç”Ÿç‚¹å¯¹é½é—®é¢˜åˆ†æ");const s={lon:121.47,lat:31.23},n=c.degToRad(s.lat),e=c.degToRad(s.lon),i=new a(Math.cos(n)*Math.sin(e),Math.sin(n),Math.cos(n)*Math.cos(e)),t=new a(Math.cos(n)*Math.cos(e),Math.sin(n),-Math.cos(n)*Math.sin(e));console.log("ä¸Šæµ·åŸå§‹åæ ‡:",s),console.log("åŸå§‹å…¬å¼ç»“æœ(é”™è¯¯):",{x:+i.x.toFixed(4),y:+i.y.toFixed(4),z:+i.z.toFixed(4)}),console.log("ä¿®å¤åå…¬å¼ç»“æœ(Three.jsåæ ‡ç³»æ ¡æ­£):",{x:+t.x.toFixed(4),y:+t.y.toFixed(4),z:+t.z.toFixed(4)});const o=c.radToDeg(Math.atan2(t.x,t.z)),h=c.radToDeg(Math.asin(c.clamp(t.y,-1,1)));console.log("ä¿®å¤åç›¸æœºæœå‘:",{yaw:o.toFixed(2)+"Â°",pitch:h.toFixed(2)+"Â°"}),offsets.forEach(l=>{const x=c.degToRad(s.lon+l),d=new a(Math.cos(n)*Math.sin(x),Math.sin(n),Math.cos(n)*Math.cos(x)),M=c.radToDeg(Math.atan2(d.x,d.z)),r=c.radToDeg(Math.asin(c.clamp(d.y,-1,1)));console.log(`ç»åº¦åç§» ${l}Â°:`,{è°ƒæ•´åç»åº¦:(s.lon+l).toFixed(2)+"Â°",ä¸–ç•Œåæ ‡:{x:+d.x.toFixed(4),y:+d.y.toFixed(4),z:+d.z.toFixed(4)},ç›¸æœºæœå‘:{yaw:M.toFixed(2)+"Â°",pitch:r.toFixed(2)+"Â°"},æœŸæœ›ç»“æœ:l===0?"âœ“ æ–°åæ ‡ç³»æ ¡æ­£ç»“æœ":l===-52.5?"å¯èƒ½ä¿®æ­£ç¾ä¸œåç§»":l===-90?"90Â°è¥¿ç§»æ ¡æ­£(æ—§)":"åç§»æµ‹è¯•"})}),console.groupEnd()}}export{u as CoordinateSystemDebugger};
