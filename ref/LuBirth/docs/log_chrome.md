chunk-RC3YDMAO.js?v=f528f50b:21551 Download the React DevTools for a better development experience: https://reactjs.org/link/react-devtools
main.tsx:10 [Main] React root created
main.tsx:12 [Main] App render called
ephemeris.ts:449 [toUTCFromLocal] 1993-08-01T11:00 (lon:121.4737) -> UTC: 1993-08-01T03:00:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间3:0 对应本地时间11:0
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 1, y: 0, z: 0}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '0.0', altitude: '0.0'}
content.js:1286 [AeScape] 准备初始化悬浮球
content.js:33 [AeScape] 悬浮球系统初始化开始
content.js:146 [AeScape] URL检查: http://localhost:5173/?debug=1, 应排除: false
content.js:1328 [AeScape] 内容脚本已加载
ephemeris.ts:449 [toUTCFromLocal] 2025-09-06T17:13 (lon:121.5) -> UTC: 2025-09-06T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
App.tsx:22 [App] mounted
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7455856506149826, y: 0.11001427521144724, z: 0.6572662298085404}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '270.3', altitude: '11.7'}
content.js:157 [AeScape] 用户设置检查: false
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-06T17:13 (lon:121.5) -> UTC: 2025-09-06T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_daymap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_nightmap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_normal_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_specular_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_moon.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_normal.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_displacement.jpg
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '❌', earthNight: '❌', earthNormal: '❌', earthSpecular: '❌', earthClouds: '❌', …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: false, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_daymap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_nightmap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_normal_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_specular_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_moon.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_normal.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_displacement.jpg
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '❌', earthNight: '❌', earthNormal: '❌', earthSpecular: '❌', earthClouds: '❌', …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: false, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.746', y: '0.110', z: '0.657', lightingSide: '右侧', …}
positionUtils.ts:51 [SimpleCamera] {position: Array(3), fov: 45, near: 0.01, far: 400, mode: 'single-render-system', …}
positionUtils.ts:166 [SimpleExposure] {exposure: 1}
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_daymap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_nightmap.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_normal_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_specular_map.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_earth_clouds.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_moon.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_normal.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/2k_moon_displacement.jpg
textureLoader.ts:77 [TextureLoader] 尝试加载纹理: /textures/8k_stars_milky_way.jpg
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '❌', earthNight: '❌', earthNormal: '❌', earthSpecular: '❌', earthClouds: '❌', …}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: false, …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: false, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.746', y: '0.110', z: '0.657', lightingSide: '右侧', …}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_nightmap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_nightmap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_nightmap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_nightmap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_nightmap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_nightmap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_specular_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_specular_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_specular_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_specular_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_specular_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_specular_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_normal.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_normal.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_normal.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_normal.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_normal.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_normal.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_daymap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_daymap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_daymap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_daymap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_daymap.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_daymap.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_displacement.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_displacement.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_displacement.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_displacement.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/2k_moon_displacement.jpg {width: 2048, height: 1024, src: 'http://localhost:5173/textures/2k_moon_displacement.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_stars_milky_way.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_stars_milky_way.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_normal_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_normal_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_normal_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_normal_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_normal_map.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_normal_map.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_moon.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_moon.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_moon.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_moon.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_moon.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_moon.jpg'}
textureLoader.ts:83 [TextureLoader] ✅ 纹理加载成功: /textures/8k_earth_clouds.jpg {width: 8192, height: 4096, src: 'http://localhost:5173/textures/8k_earth_clouds.jpg'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '✅', earthNight: '✅', earthNormal: '✅', earthSpecular: '✅', earthClouds: '❌', …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '✅', earthNight: '✅', earthNormal: '✅', earthSpecular: '✅', earthClouds: '❌', …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.746', y: '0.110', z: '0.657', lightingSide: '右侧', …}
SimpleTest.tsx:35 [MilkyWay] texture loaded: {image: 'http://localhost:5173/textures/8k_stars_milky_way.jpg', repeat: Array(2), yawDeg: -61, pitchDeg: 0, sphereRadius: 120, …}
textureLoader.ts:216 [TextureLoader] 纹理加载状态: {earthMap: '✅', earthNight: '✅', earthNormal: '✅', earthSpecular: '✅', earthClouds: '✅', …}
content.js:1967 Preloaded 316 local cards to cache
content.js:2110 Starting periodic update mechanism...
content.js:2122 Periodic update started with 180s interval
content.js:1972 Force preloading more content...
content.js:1995 Force preloading facts: 8 cards needed
content.js:1995 Force preloading advice: 10 cards needed
ephemeris.ts:449 [toUTCFromLocal] 2025-09-11T17:13 (lon:121.5) -> UTC: 2025-09-11T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.752788477548537, y: 0.07735158224338606, z: 0.65370195104084}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '268.9', altitude: '10.4'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-11T17:13 (lon:121.5) -> UTC: 2025-09-11T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '49.1', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.756', y: '-0.133', z: '0.641', lightingSide: '右侧', …}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-09T17:13 (lon:121.5) -> UTC: 2025-09-09T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7499820958140974, y: 0.0905039525755336, z: 0.655237278034835}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '269.5', altitude: '10.9'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-09T17:13 (lon:121.5) -> UTC: 2025-09-09T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '21.9', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.373', y: '-0.188', z: '0.909', lightingSide: '右侧', …}
ephemeris.ts:449 [toUTCFromLocal] 2025-08-31T17:13 (lon:121.5) -> UTC: 2025-08-31T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7362978245361769, y: 0.1480815340500591, z: 0.6602555360287974}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '272.0', altitude: '13.2'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-08-31T17:13 (lon:121.5) -> UTC: 2025-08-31T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '88.6', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '1.000', y: '-0.005', z: '0.024', lightingSide: '右侧', …}
content.js:1995 Force preloading catfacts: 6 cards needed
content.js:1995 Force preloading cocktails: 9 cards needed
ephemeris.ts:449 [toUTCFromLocal] 2025-08-11T17:13 (lon:121.5) -> UTC: 2025-08-11T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7047824175904067, y: 0.2615272150453955, z: 0.6594583077390269}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '277.4', altitude: '17.5'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-08-11T17:13 (lon:121.5) -> UTC: 2025-08-11T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '26.2', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.441', y: '-0.182', z: '0.879', lightingSide: '右侧', …}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-15T17:13 (lon:121.5) -> UTC: 2025-09-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.758040630386907, y: 0.05076194687343687, z: 0.6502289038732737}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '267.8', altitude: '9.3'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-09-15T17:13 (lon:121.5) -> UTC: 2025-09-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '102.0', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.978', y: '0.042', z: '-0.204', lightingSide: '右侧', …}
content.js:1995 Force preloading datafacts: 25 cards needed
// 验证左侧光照修复效果的测试脚本
// 测试修复后的光照侧判断逻辑

const testLightingFix = () => {
  console.log('🧪 测试光照侧判断修复效果');
  console.log('修复前阈值: 0.3, 修复后阈值: 0.15');
  console.log('');
  
  // 测试不同的相位角
  const testAngles = [
    { angle: 0, expected: '前方' },
    { angle: 45, expected: '右侧' },
    { angle: 90, expected: '右侧' },
    { angle: 135, expected: '右侧' },
    { angle: 180, expected: '后方' },
    { angle: 225, expected: '左侧' },  // 关键测试点
    { angle: 270, expected: '左侧' },  // 关键测试点
    { angle: 315, expected: '左侧' },  // 关键测试点
    { angle: 360, expected: '前方' }
  ];
  
  testAngles.forEach(({ angle, expected }) => {
    const a = angle * Math.PI / 180;
    
    // 模拟正交基向量（基于实际log数据）
    const F = new THREE.Vector3(0.1, 0.2, 0.97).normalize();
    const R = new THREE.Vector3(-0.97, 0.1, 0.1).normalize();
    const U = new THREE.Vector3(-0.1, 0.97, -0.2).normalize();
    
    // 计算太阳方向
    const S = new THREE.Vector3()
      .add(R.clone().multiplyScalar(-Math.sin(a)))
      .add(F.clone().multiplyScalar(Math.cos(a)))
      .normalize();
    
    // 修复后的判断逻辑
    const lightingSide = S.x > 0.15 ? '右侧' : S.x < -0.15 ? '左侧' : S.z > 0.15 ? '前方' : S.z < -0.15 ? '后方' : '其他方向';
    
    // 修复前的判断逻辑（用于对比）
    const lightingSideOld = S.x > 0.3 ? '右侧' : S.x < -0.3 ? '左侧' : S.z > 0.3 ? '前方' : S.z < -0.3 ? '后方' : '其他方向';
    
    console.log(`${angle}°:`);
    console.log(`  太阳方向: (${S.x.toFixed(3)}, ${S.y.toFixed(3)}, ${S.z.toFixed(3)})`);
    console.log(`  期望光照: ${expected}`);
    console.log(`  修复前: ${lightingSideOld} ${lightingSideOld === expected ? '✅' : '❌'}`);
    console.log(`  修复后: ${lightingSide} ${lightingSide === expected ? '✅' : '❌'}`);
    console.log('');
  });
  
  console.log('🎯 重点检查左侧光照范围 (225°-315°):');
  const leftAngles = [225, 240, 270, 300, 315];
  
  leftAngles.forEach(angle => {
    const a = angle * Math.PI / 180;
    
    const F = new THREE.Vector3(0.1, 0.2, 0.97).normalize();
    const R = new THREE.Vector3(-0.97, 0.1, 0.1).normalize();
    
    const S = new THREE.Vector3()
      .add(R.clone().multiplyScalar(-Math.sin(a)))
      .add(F.clone().multiplyScalar(Math.cos(a)))
      .normalize();
    
    const lightingSide = S.x > 0.15 ? '右侧' : S.x < -0.15 ? '左侧' : S.z > 0.15 ? '前方' : S.z < -0.15 ? '后方' : '其他方向';
    
    console.log(`${angle}°: 太阳方向x=${S.x.toFixed(3)}, 光照侧=${lightingSide} ${lightingSide === '左侧' ? '✅' : '❌'}`);
  });
};

// 运行测试
testLightingFix();
VM1714:5 🧪 测试光照侧判断修复效果
VM1714:6 修复前阈值: 0.3, 修复后阈值: 0.15
VM1714:7 
VM1714:42 0°:
VM1714:43   太阳方向: (0.100, 0.201, 0.974)
VM1714:44   期望光照: 前方
VM1714:45   修复前: 前方 ✅
VM1714:46   修复后: 前方 ✅
VM1714:47 
VM1714:42 45°:
VM1714:43   太阳方向: (0.779, 0.071, 0.623)
VM1714:44   期望光照: 右侧
VM1714:45   修复前: 右侧 ✅
VM1714:46   修复后: 右侧 ✅
VM1714:47 
VM1714:42 90°:
VM1714:43   太阳方向: (0.990, -0.102, -0.102)
VM1714:44   期望光照: 右侧
VM1714:45   修复前: 右侧 ✅
VM1714:46   修复后: 右侧 ✅
VM1714:47 
VM1714:42 135°:
VM1714:43   太阳方向: (0.622, -0.212, -0.753)
VM1714:44   期望光照: 右侧
VM1714:45   修复前: 右侧 ✅
VM1714:46   修复后: 右侧 ✅
VM1714:47 
VM1714:42 180°:
VM1714:43   太阳方向: (-0.100, -0.201, -0.974)
VM1714:44   期望光照: 后方
VM1714:45   修复前: 后方 ✅
VM1714:46   修复后: 后方 ✅
VM1714:47 
VM1714:42 225°:
VM1714:43   太阳方向: (-0.779, -0.071, -0.623)
VM1714:44   期望光照: 左侧
VM1714:45   修复前: 左侧 ✅
VM1714:46   修复后: 左侧 ✅
VM1714:47 
VM1714:42 270°:
VM1714:43   太阳方向: (-0.990, 0.102, 0.102)
VM1714:44   期望光照: 左侧
VM1714:45   修复前: 左侧 ✅
VM1714:46   修复后: 左侧 ✅
VM1714:47 
VM1714:42 315°:
VM1714:43   太阳方向: (-0.622, 0.212, 0.753)
VM1714:44   期望光照: 左侧
VM1714:45   修复前: 左侧 ✅
VM1714:46   修复后: 左侧 ✅
VM1714:47 
VM1714:42 360°:
VM1714:43   太阳方向: (0.100, 0.201, 0.974)
VM1714:44   期望光照: 前方
VM1714:45   修复前: 前方 ✅
VM1714:46   修复后: 前方 ✅
VM1714:47 
VM1714:50 🎯 重点检查左侧光照范围 (225°-315°):
VM1714:66 225°: 太阳方向x=-0.779, 光照侧=左侧 ✅
VM1714:66 240°: 太阳方向x=-0.915, 光照侧=左侧 ✅
VM1714:66 270°: 太阳方向x=-0.990, 光照侧=左侧 ✅
VM1714:66 300°: 太阳方向x=-0.800, 光照侧=左侧 ✅
VM1714:66 315°: 太阳方向x=-0.622, 光照侧=左侧 ✅
undefined
content.js:1995 Force preloading gathas: 15 cards needed
content.js:2024 Force preload completed. Total cache size: 363
ephemeris.ts:449 [toUTCFromLocal] 2025-10-15T17:13 (lon:121.5) -> UTC: 2025-10-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7742255745707505, y: -0.14762638419558846, z: 0.6154520374244674}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '259.1', altitude: '1.5'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-10-15T17:13 (lon:121.5) -> UTC: 2025-10-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '109.9', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.940', y: '0.069', z: '-0.334', lightingSide: '右侧', …}
ephemeris.ts:449 [toUTCFromLocal] 2025-11-15T17:13 (lon:121.5) -> UTC: 2025-11-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
constants.ts:50 ✅ 天文常数验证通过
SimpleTest.tsx:572 [LightInfo] Raw sunWorld: {x: 0.7436300249966248, y: -0.31335421038013594, z: 0.5906128382964263}
SimpleTest.tsx:573 [LightInfo] Real sun angles from ephemeris: {azimuth: '250.8', altitude: '-3.7'}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
textureLoader.ts:193 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
ephemeris.ts:449 [toUTCFromLocal] 2025-11-15T17:13 (lon:121.5) -> UTC: 2025-11-15T09:13:00.000Z (offset: 8h)
ephemeris.ts:450 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
Moon.tsx:143 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '126.3', F: Array(3), R: Array(3), …}
Earth.tsx:210 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
AtmosphereEffects.tsx:88 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
Clouds.tsx:162 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
Moon.tsx:443 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
Moon.tsx:489 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.805', y: '0.120', z: '-0.580', lightingSide: '右侧', …}
 [toUTCFromLocal] 2025-11-18T17:13 (lon:121.5) -> UTC: 2025-11-18T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 ✅ 天文常数验证通过
 [LightInfo] Raw sunWorld: {x: 0.7389194549360161, y: -0.325505224702335, z: 0.5899528691417166}
 [LightInfo] Real sun angles from ephemeris: {azimuth: '250.1', altitude: '-3.9'}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [toUTCFromLocal] 2025-11-18T17:13 (lon:121.5) -> UTC: 2025-11-18T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '159.0', F: Array(3), R: Array(3), …}
 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.358', y: '0.189', z: '-0.914', lightingSide: '右侧', …}
 [toUTCFromLocal] 2025-11-27T17:13 (lon:121.5) -> UTC: 2025-11-27T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 ✅ 天文常数验证通过
 [LightInfo] Raw sunWorld: {x: 0.7238177515908254, y: -0.35633550473625536, z: 0.5908577413780414}
 [LightInfo] Real sun angles from ephemeris: {azimuth: '248.2', altitude: '-4.4'}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [toUTCFromLocal] 2025-11-27T17:13 (lon:121.5) -> UTC: 2025-11-27T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '100.7', F: Array(3), R: Array(3), …}
 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.983', y: '0.038', z: '-0.182', lightingSide: '右侧', …}
 [toUTCFromLocal] 2025-11-28T17:13 (lon:121.5) -> UTC: 2025-11-28T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 ✅ 天文常数验证通过
 [LightInfo] Raw sunWorld: {x: 0.7220924698484499, y: -0.3592125457145015, z: 0.5912265318720673}
 [LightInfo] Real sun angles from ephemeris: {azimuth: '248.0', altitude: '-4.5'}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [toUTCFromLocal] 2025-11-28T17:13 (lon:121.5) -> UTC: 2025-11-28T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '88.7', F: Array(3), R: Array(3), …}
 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '1.000', y: '-0.005', z: '0.022', lightingSide: '右侧', …}
 [toUTCFromLocal] 2025-11-29T17:13 (lon:121.5) -> UTC: 2025-11-29T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 ✅ 天文常数验证通过
 [LightInfo] Raw sunWorld: {x: 0.7203647381676308, y: -0.3619756965159936, z: 0.5916487464166912}
 [LightInfo] Real sun angles from ephemeris: {azimuth: '247.8', altitude: '-4.5'}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: true, useMilkyWay: true}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [TextureLoader] 开始加载纹理，配置: {useTextures: true, useClouds: false, useMilkyWay: false}
 [toUTCFromLocal] 2025-11-29T17:13 (lon:121.5) -> UTC: 2025-11-29T09:13:00.000Z (offset: 8h)
 [toUTCFromLocal] 注意：UTC时间9:13 对应本地时间17:13
 [SimpleMoon Orthogonal Basis Debug] {cameraPosition: Array(3), moonPosition: Array(3), phaseAngleDeg: '76.4', F: Array(3), R: Array(3), …}
 [SimpleEarth] {position: Array(3), size: 2.0503571337468207, lightDirection: Array(3), useTextures: true, hasDayMap: true, …}
 [SimpleAtmosphere] {earthSize: 2.0503571337468207, earthY: 0, rimStrength: 0.15, rimWidth: 0.08, earthGlowStrength: 0.8, …}
 [SimpleClouds] {radius: 2.0680000468112856, position: Array(3), yawDeg: 0, pitchDeg: 0, lightDir: Array(3), …}
 [SimpleMoon Debug] {position: Array(3), radius: 0.44, lightDirection: Array(3), useTextures: true, hasMap: true, …}
 [SimpleMoon Lighting Analysis] {sunDirection: Array(3), x: '0.972', y: '-0.048', z: '0.231', lightingSide: '右侧', …}
