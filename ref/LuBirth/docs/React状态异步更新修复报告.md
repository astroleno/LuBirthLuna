# ReactçŠ¶æ€å¼‚æ­¥æ›´æ–°ä¿®å¤æŠ¥å‘Š

## ğŸš¨ **é—®é¢˜è¯Šæ–­**

ç”¨æˆ·åé¦ˆï¼š"è¿˜æ˜¯ä¼šè¢«è°ƒå›å»"

ä»æ—¥å¿—ä¸­å‘ç°ï¼š
- **ç¬¬403è¡Œ**ï¼š`[EarthRotation] UTCæ—¶é—´: 6:02, è®¡ç®—è‡ªè½¬è§’åº¦: 90.5Â°`
- è¿™è¯´æ˜**è‡ªåŠ¨æ›´æ–°æœºåˆ¶ä»åœ¨è¿è¡Œ**ï¼Œå³ä½¿ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹äº†æ—¶é—´

### **æ ¹æœ¬åŸå› **
**ReactçŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„**ï¼

**é—®é¢˜åˆ†æ**ï¼š
1. **ç¬¬894è¡Œ**ï¼š`setUserModifiedTime(true)` - è®¾ç½®ç”¨æˆ·ä¿®æ”¹æ ‡å¿—
2. **ç¬¬644è¡Œ**ï¼šæ£€æŸ¥`userModifiedTime` - ä½†çŠ¶æ€æ›´æ–°æœ‰å»¶è¿Ÿ
3. **ç¬¬646è¡Œ**ï¼š`clearInterval(interval)` - ä½†å¯èƒ½å·²ç»å¤ªæ™šäº†

**å…·ä½“é—®é¢˜**ï¼š
- å½“ç”¨æˆ·ä¿®æ”¹æ—¶é—´æ—¶ï¼Œ`setUserModifiedTime(true)`è¢«è°ƒç”¨
- ä½†`userModifiedTime`çš„å€¼ä¸ä¼šç«‹å³æ›´æ–°
- `setInterval`ä¸­çš„æ£€æŸ¥ä»ç„¶çœ‹åˆ°æ—§å€¼ï¼ˆ`false`ï¼‰
- æ‰€ä»¥`clearInterval`æ²¡æœ‰è¢«æ‰§è¡Œ
- è‡ªåŠ¨æ›´æ–°ç»§ç»­è¿è¡Œï¼Œè¦†ç›–ç”¨æˆ·è®¾ç½®

## ğŸ”§ **ä¿®å¤æ–¹æ¡ˆ**

### **ä¿®å¤å†…å®¹**
ä½¿ç”¨`useRef`æ¥å­˜å‚¨ç”¨æˆ·ä¿®æ”¹çŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥ç«‹å³ç”Ÿæ•ˆï¼š

```typescript
// æ·»åŠ refå­˜å‚¨ç”¨æˆ·ä¿®æ”¹çŠ¶æ€
const userModifiedTimeRef = React.useRef<boolean>(false);

// åœ¨setIntervalä¸­æ£€æŸ¥refè€Œä¸æ˜¯state
if (userModifiedTimeRef.current) {
  console.log('[EarthRotation] ç”¨æˆ·å·²æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´ï¼Œåœæ­¢è‡ªåŠ¨æ›´æ–°');
  clearInterval(interval);
  return;
}

// ç”¨æˆ·ä¿®æ”¹æ—¶é—´æ—¶ç«‹å³è®¾ç½®ref
userModifiedTimeRef.current = true;

// é‡ç½®æ—¶ç«‹å³é‡ç½®ref
userModifiedTimeRef.current = false;
```

### **ä¿®å¤å‰åå¯¹æ¯”**

**ä¿®å¤å‰**ï¼š
```typescript
// åªä½¿ç”¨state
const [userModifiedTime, setUserModifiedTime] = useState<boolean>(false);

// æ£€æŸ¥stateï¼ˆå¼‚æ­¥æ›´æ–°ï¼Œå¯èƒ½å»¶è¿Ÿï¼‰
if (userModifiedTime) {
  clearInterval(interval);
  return;
}

// è®¾ç½®stateï¼ˆå¼‚æ­¥æ›´æ–°ï¼‰
setUserModifiedTime(true);
```

**ä¿®å¤å**ï¼š
```typescript
// åŒæ—¶ä½¿ç”¨stateå’Œref
const [userModifiedTime, setUserModifiedTime] = useState<boolean>(false);
const userModifiedTimeRef = React.useRef<boolean>(false);

// æ£€æŸ¥refï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰
if (userModifiedTimeRef.current) {
  clearInterval(interval);
  return;
}

// åŒæ—¶è®¾ç½®stateå’Œref
setUserModifiedTime(true);
userModifiedTimeRef.current = true; // ç«‹å³ç”Ÿæ•ˆ
```

## ğŸ“Š **ä¿®å¤æ•ˆæœé¢„æœŸ**

### **ä¿®å¤å‰**
- ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´
- `setUserModifiedTime(true)`è¢«è°ƒç”¨
- ä½†`userModifiedTime`çŠ¶æ€æ›´æ–°æœ‰å»¶è¿Ÿ
- `setInterval`ä¸­çš„æ£€æŸ¥ä»ç„¶çœ‹åˆ°æ—§å€¼
- `clearInterval`æ²¡æœ‰è¢«æ‰§è¡Œ
- è‡ªåŠ¨æ›´æ–°ç»§ç»­è¿è¡Œï¼Œè¦†ç›–ç”¨æˆ·è®¾ç½®

### **ä¿®å¤å**
- ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´
- `setUserModifiedTime(true)`è¢«è°ƒç”¨
- `userModifiedTimeRef.current = true`ç«‹å³ç”Ÿæ•ˆ
- `setInterval`ä¸­çš„æ£€æŸ¥ç«‹å³çœ‹åˆ°æ–°å€¼
- `clearInterval`ç«‹å³æ‰§è¡Œ
- è‡ªåŠ¨æ›´æ–°å®Œå…¨åœæ­¢

## ğŸ¯ **éªŒè¯æ–¹æ³•**

### **1. æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´æµ‹è¯•**
1. è®¾ç½®æ—¶é—´ä¸ºä»»æ„æ—¶é—´ï¼ˆå¦‚16:02ï¼‰
2. è§‚å¯Ÿæ§åˆ¶å°æ˜¯å¦æ˜¾ç¤º"ç”¨æˆ·å·²æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´ï¼Œåœæ­¢è‡ªåŠ¨æ›´æ–°"
3. ç­‰å¾…10ç§’ï¼Œæ£€æŸ¥æ—¶é—´æ˜¯å¦è¢«è‡ªåŠ¨æ›´æ–°è¦†ç›–
4. **é¢„æœŸç»“æœ**ï¼šæ—¶é—´åº”è¯¥ä¿æŒä¸å˜ï¼Œä¸å†è¢«è°ƒå›å»

### **2. è‡ªåŠ¨æ›´æ–°æ¢å¤æµ‹è¯•**
1. ç‚¹å‡»"é‡ç½®å½“å‰æ—¶é—´"æŒ‰é’®
2. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æ˜¾ç¤º"é‡ç½®ä¸ºå½“å‰æ—¶é—´ï¼Œæ¢å¤è‡ªåŠ¨æ›´æ–°"
3. ç­‰å¾…10ç§’ï¼Œæ£€æŸ¥æ—¶é—´æ˜¯å¦å¼€å§‹è‡ªåŠ¨æ›´æ–°
4. **é¢„æœŸç»“æœ**ï¼šæ—¶é—´åº”è¯¥å¼€å§‹è‡ªåŠ¨æ›´æ–°

### **3. æ—¥å¿—éªŒè¯**
- æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´åï¼Œä¸åº”è¯¥å†çœ‹åˆ°`[EarthRotation] UTCæ—¶é—´:`çš„æ—¥å¿—
- åªæœ‰ç‚¹å‡»"é‡ç½®å½“å‰æ—¶é—´"åï¼Œæ‰åº”è¯¥é‡æ–°çœ‹åˆ°è‡ªåŠ¨æ›´æ–°æ—¥å¿—

## ğŸ” **æŠ€æœ¯ç»†èŠ‚**

### **ReactçŠ¶æ€æ›´æ–°æœºåˆ¶**
```typescript
// ReactçŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„
setUserModifiedTime(true); // ä¸ä¼šç«‹å³æ›´æ–°userModifiedTimeçš„å€¼
console.log(userModifiedTime); // ä»ç„¶æ˜¾ç¤ºæ—§å€¼

// ä½¿ç”¨refå¯ä»¥ç«‹å³ç”Ÿæ•ˆ
userModifiedTimeRef.current = true; // ç«‹å³æ›´æ–°
console.log(userModifiedTimeRef.current); // ç«‹å³æ˜¾ç¤ºæ–°å€¼
```

### **useRef vs useState**
- **useState**ï¼šå¼‚æ­¥æ›´æ–°ï¼Œç”¨äºè§¦å‘é‡æ–°æ¸²æŸ“
- **useRef**ï¼šåŒæ­¥æ›´æ–°ï¼Œç”¨äºå­˜å‚¨å¯å˜å€¼ï¼Œä¸è§¦å‘é‡æ–°æ¸²æŸ“

### **ä¿®å¤ç­–ç•¥**
```typescript
// åŒæ—¶ä½¿ç”¨stateå’Œref
const [userModifiedTime, setUserModifiedTime] = useState<boolean>(false);
const userModifiedTimeRef = React.useRef<boolean>(false);

// ç”¨æˆ·ä¿®æ”¹æ—¶åŒæ—¶æ›´æ–°ä¸¤è€…
setUserModifiedTime(true); // ç”¨äºUIçŠ¶æ€
userModifiedTimeRef.current = true; // ç”¨äºç«‹å³æ£€æŸ¥

// æ£€æŸ¥æ—¶ä½¿ç”¨ref
if (userModifiedTimeRef.current) {
  // ç«‹å³ç”Ÿæ•ˆ
}
```

## ğŸš€ **éƒ¨ç½²çŠ¶æ€**

### **å·²ä¿®å¤æ–‡ä»¶**
- âœ… `src/SimpleTest.tsx`ï¼šä¿®å¤ReactçŠ¶æ€å¼‚æ­¥æ›´æ–°é—®é¢˜

### **ä¿®å¤å†…å®¹**
1. âœ… æ·»åŠ `userModifiedTimeRef`ç”¨äºç«‹å³æ£€æŸ¥
2. âœ… ä¿®æ”¹`setInterval`ä¸­çš„æ£€æŸ¥é€»è¾‘ä½¿ç”¨ref
3. âœ… ä¿®æ”¹ç”¨æˆ·ä¿®æ”¹æ—¶é—´æ—¶åŒæ—¶è®¾ç½®ref
4. âœ… ä¿®æ”¹é‡ç½®å‡½æ•°æ—¶åŒæ—¶é‡ç½®ref

### **æµ‹è¯•å»ºè®®**
1. æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´ï¼ŒéªŒè¯æ˜¯å¦ç«‹å³åœæ­¢è‡ªåŠ¨æ›´æ–°
2. ç‚¹å‡»"é‡ç½®å½“å‰æ—¶é—´"ï¼ŒéªŒè¯æ˜¯å¦æ¢å¤è‡ªåŠ¨æ›´æ–°
3. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ç¡®è®¤è¡Œä¸ºæ­£ç¡®

## ğŸ“ **æ€»ç»“**

**é—®é¢˜æ ¹æº**ï¼šReactçŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œ`setUserModifiedTime(true)`ä¸ä¼šç«‹å³æ›´æ–°`userModifiedTime`çš„å€¼ã€‚

**ä¿®å¤æ–¹æ¡ˆ**ï¼šä½¿ç”¨`useRef`å­˜å‚¨ç”¨æˆ·ä¿®æ”¹çŠ¶æ€ï¼Œç¡®ä¿æ£€æŸ¥æ—¶èƒ½ç«‹å³çœ‹åˆ°æœ€æ–°å€¼ã€‚

**é¢„æœŸæ•ˆæœ**ï¼š
- ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹æ—¶é—´åï¼Œè‡ªåŠ¨æ›´æ–°ç«‹å³åœæ­¢
- æ—¶é—´è®¾ç½®å¾—åˆ°ä¿æŒï¼Œä¸å†è¢«è°ƒå›å»
- "é‡ç½®å½“å‰æ—¶é—´"åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

**ä¿®å¤æ—¶é—´**ï¼š2025-01-14  
**ä¿®å¤çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**ï¼šâ³ å¾…éªŒè¯
