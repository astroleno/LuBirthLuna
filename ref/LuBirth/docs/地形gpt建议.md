做一颗“稳定、好调、性能友好”的地球：不用 Three.js 的 shadowMap，而是让光照“以为”地形起伏很大，从而得到可信的山体明暗与阴影；贴脸时再补近景细节。

分层架构（从下到上）

基底几何（低频形体）

单球体即可；分段按镜头挑（远景 320–384；低空 640–768）。

只做低频位移让大形起伏成立（山脉轮廓），位移强度近处可夸张 2–4×，远处回归 1×。

DEM 法线（片元级 hillshade，大形明暗）

用同一张高程图在片元里做梯度（Sobel/差分），得“DEM 法线”。

与几何法线以 0.4–0.6 的权重混合；这是提升“山脊/谷地”立体感的主力。

高度图自阴影（片元级地平线遮挡）

沿太阳方向在高度图上做 8–14 次前向采样，判断是否被更高地形挡住，得到 0–1 的遮挡系数。

将其乘到漫反射项（不要乘到高光），就得到“山体阴影更深”的观感。

关键旋钮：步数（细腻↔性能）、每步 UV 距离（阴影长度/软硬）、高度/距离比例（阴影强弱）。

近景细节法线（triplanar，无接缝）

选择 2–4K 的可平铺“岩面/土壤”法线；以 triplanar 投影到地表，按距离渐隐。

细节法线权重 0.6–0.9；平铺密度 200–320（依据镜头/FOV 调）。

AO（可选，锦上添花）

有资源：叠一张烘焙 AO 贴图（equirect）；

没资源：用“斜率 AO”（梯度越大越暗）做便宜近似，强度 0.3–0.6。

POM（可选，只在贴脸）

仅作用在“近景细节层”，相机很近时启用。

步数 10–16，自适应距离；超出阈值立即关闭，避免拖慢。